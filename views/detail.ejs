<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title><%= rest.name %> | è©³æƒ…</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/index.css">
    <link rel="stylesheet" href="/detail.css">
</head>
<body>
    <nav><a href="/" class="logo">é£Ÿå…‰åœ°åœ–</a></nav>
    <div class="container">
        <div class="detail-flex">
            <div style="flex:1; min-width:320px; border-radius:20px; overflow:hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                <img src="<%= rest.image_url %>" alt="<%= rest.name %>" style="width:100%; display:block;">
            </div>
            <div class="info-panel">
                <h1><%= rest.name %></h1>
                <p class="description"><%= rest.description %></p>
                <hr style="border:0; border-top:1px solid #f2f2f2; margin:20px 0;">
                <p>ğŸ“ åœ°å€ï¼š<%= rest.address %></p>
                <p>ğŸ“ é›»è©±ï¼š<%= rest.phone %></p>
                <div class="btn-group">
                    <a href="https://www.google.com/maps/search/?api=1&query=<%= encodeURIComponent(rest.address) %>" target="_blank" class="btn btn-map">åœ°åœ–å°èˆª</a>
                    <a href="tel:<%= rest.phone %>" class="btn btn-phone">æ’¥æ‰“é›»è©±</a>
                </div>
            </div>
        </div>
        <div class="comment-section">
            <h3>ğŸ’¬ ç•™è¨€è©•è«–</h3>
            <div id="commentList">
                <% rest.comments.reverse().forEach(c => { %>
                    <div class="comment-item"><%= c.text %> <small style="float:right;"><%= c.date %></small></div>
                <% }) %>
            </div>
            <div class="input-group">
                <input type="text" id="msg" placeholder="åˆ†äº«ä½ çš„é£Ÿè¨˜...">
                <button onclick="sendMsg()" class="btn-send">é€å‡º</button>
            </div>
        </div>
    </div>
    <script>
        async function sendMsg() {
            const text = document.getElementById('msg').value;
            if(!text) return;
            await fetch(`/api/restaurants/<%= rest.id %>/comments`, {
                method:'POST', headers:{'Content-Type':'application/json'},
                body: JSON.stringify({text})
            });
            location.reload();
        }
    </script>
</body>
</html>